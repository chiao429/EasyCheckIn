# Google Sheet 範本設定

## 標準範本格式

### 第一列（標題列）

| A | B | C | D |
|---|---|---|---|
| 序號 | 姓名 | 到達時間 | 已到 |

**重要提示**：
- 標題必須完全一致（包括中文字）
- 不要有額外的空格
- 這四個欄位是必須的

### 資料列（從第二列開始）

| A | B | C | D |
|---|---|---|---|
| 001 | 王小明 | | |
| 002 | 李小華 | | |
| 003 | 張小美 | | |
| 004 | 陳大同 | | |
| 005 | 林小芳 | | |

**填寫說明**：
- **序號**（必填）：可以是數字、英文或組合，例如：001、A001、2024-001
- **姓名**（必填）：參加者的姓名
- **到達時間**（自動）：系統會在簽到時自動填寫
- **已到**（自動）：系統會在簽到時自動填寫 TRUE

## 範例資料

### 小型活動（20人以下）

```
序號    姓名      到達時間    已到
001     王小明
002     李小華
003     張小美
004     陳大同
005     林小芳
006     黃志明
007     吳淑芬
008     周建國
009     鄭雅婷
010     劉俊傑
```

### 中型活動（100人）

使用序號格式：`A001`, `A002`, ..., `A100`

```
序號    姓名      到達時間    已到
A001    參加者1
A002    參加者2
A003    參加者3
...
A100    參加者100
```

### 大型活動（分組管理）

使用分組序號：`G1-001`, `G1-002`, `G2-001`, `G2-002`

```
序號      姓名        到達時間    已到
G1-001    第1組-成員1
G1-002    第1組-成員2
G1-003    第1組-成員3
G2-001    第2組-成員1
G2-002    第2組-成員2
G2-003    第2組-成員3
```

## 進階設定

### 額外欄位（可選）

你可以在 E 欄之後新增額外欄位，系統不會影響這些欄位：

| A | B | C | D | E | F | G |
|---|---|---|---|---|---|---|
| 序號 | 姓名 | 到達時間 | 已到 | 電話 | Email | 備註 |
| 001 | 王小明 | | | 0912345678 | wang@example.com | VIP |

### 多個工作表

如果需要管理多個活動，可以在同一個 Google Sheet 中建立多個工作表：

- **工作表1**：春季活動
- **工作表2**：夏季活動
- **工作表3**：秋季活動

**注意**：目前系統預設讀取第一個工作表，如需讀取其他工作表，需要修改程式碼。

## 資料匯入技巧

### 從 Excel 匯入

1. 在 Excel 中準備好資料（序號、姓名）
2. 複製資料
3. 在 Google Sheet 中，從 A2 儲存格開始貼上
4. 確認格式正確

### 從 CSV 匯入

1. 準備 CSV 檔案（UTF-8 編碼）
   ```csv
   序號,姓名,到達時間,已到
   001,王小明,,
   002,李小華,,
   003,張小美,,
   ```

2. 在 Google Sheets 中：
   - 檔案 → 匯入
   - 上傳 CSV 檔案
   - 選擇「取代目前工作表」或「插入新工作表」

### 批次產生序號

使用 Google Sheets 公式自動產生序號：

在 A2 輸入：
```
=TEXT(ROW()-1,"000")
```

向下拖曳填滿，會自動產生：001, 002, 003, ...

## 權限設定

### 分享給服務帳號

1. 點擊右上角「共用」
2. 輸入服務帳號的 email（格式：`xxx@xxx.iam.gserviceaccount.com`）
3. 權限選擇「編輯者」
4. **取消勾選**「通知使用者」
5. 點擊「共用」

### 分享給其他管理員

如果有多位工作人員需要查看資料：

1. 點擊右上角「共用」
2. 輸入管理員的 Gmail
3. 權限選擇「編輯者」或「檢視者」
4. 點擊「傳送」

## 資料維護

### 簽到前

- [ ] 確認所有參加者資料已輸入
- [ ] 檢查序號沒有重複
- [ ] 檢查姓名拼寫正確
- [ ] 清空「到達時間」和「已到」欄位（如果是重複使用的 Sheet）

### 簽到中

- [ ] 定期重新整理查看簽到狀況
- [ ] 注意是否有異常（例如：同一人多次簽到）
- [ ] 記錄特殊狀況在備註欄

### 簽到後

- [ ] 匯出最終報表
- [ ] 備份 Sheet（檔案 → 建立副本）
- [ ] 統計簽到率
- [ ] 整理未簽到名單

## 常見問題

### Q: 可以修改標題名稱嗎？

A: 不建議。系統依賴這些標題來定位資料。如果一定要修改，需要同步修改程式碼中的欄位名稱。

### Q: 序號可以重複嗎？

A: 不可以。系統會根據序號或姓名來識別參加者，重複會導致簽到錯誤。

### Q: 可以在簽到後修改資料嗎？

A: 可以。你可以直接在 Google Sheet 中修改任何資料，包括已簽到的記錄。

### Q: 如何重置所有簽到記錄？

A: 選取 C2:D 欄（到達時間和已到），按 Delete 鍵清空即可。

### Q: 支援多少筆資料？

A: Google Sheets 單一工作表最多支援 1000 萬個儲存格。實務上建議單一活動不超過 10,000 人。

## 範本下載

你可以複製這個範本開始使用：

**[點此複製 Google Sheet 範本](https://docs.google.com/spreadsheets/d/YOUR_TEMPLATE_ID/copy)**

（請將 YOUR_TEMPLATE_ID 替換為你的範本 Sheet ID）

## 進階功能

### 自動統計

在 Sheet 中新增統計欄位：

在 F2 輸入（總人數）：
```
=COUNTA(A2:A)
```

在 F3 輸入（已簽到）：
```
=COUNTIF(D2:D,"TRUE")
```

在 F4 輸入（未簽到）：
```
=F2-F3
```

在 F5 輸入（簽到率）：
```
=F3/F2
```

### 條件格式

讓已簽到的列自動變色：

1. 選取 A2:D（資料範圍）
2. 格式 → 條件式格式設定
3. 格式規則：自訂公式
4. 輸入：`=$D2="TRUE"`
5. 選擇背景顏色（例如：淺綠色）
6. 點擊「完成」

### 資料驗證

防止輸入錯誤的序號格式：

1. 選取 A2:A
2. 資料 → 資料驗證
3. 條件：文字包含
4. 設定你的序號規則
5. 點擊「儲存」

## 備份建議

### 自動備份

Google Sheets 會自動儲存版本記錄：

- 檔案 → 版本記錄 → 查看版本記錄
- 可以還原到任何時間點

### 手動備份

建議在活動前後手動備份：

1. 檔案 → 建立副本
2. 命名：`活動名稱_備份_日期`
3. 儲存到指定資料夾

### 匯出備份

定期匯出為 Excel 或 CSV：

1. 檔案 → 下載
2. 選擇格式：Microsoft Excel (.xlsx) 或 CSV
3. 儲存到本機電腦

## 支援

如有任何問題，請參考：
- 主要文件：`README.md`
- 設定指南：`SETUP_GUIDE.md`
- 快速開始：`QUICKSTART.md`
